{"query1": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_LineFromText('LINESTRING(62 80,70 44 ,18 66 ,62 80)',0), 1, 0, 0, 1,76,-237));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((57 87,32 31 ,86 64 ,18 8 ,57 87)),((77 47,44 61 ,74 60 ,100 86 ,77 47)),((15 39,22 65 ,8 93 ,44 37 ,15 39)),((69 49,75 2 ,36 31 ,7 58 ,69 49)))',0), 1, 0, 0, 1,358,562));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('POLYGON((100 93,90 58 ,78 78 ,86 34 ,25 62 ,77 56 ,32 1 ,100 93))',0), 1, 0, 0, 1,-327,926));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTILINESTRING((51 93,92 61 ,49 50 ,51 93), (45 67,50 7 ,22 78 ))',0), 1, 0, 0, 1,-577,964));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('LINESTRING(54 51,58 73 ,38 38 ,54 51)',0), 1, 0, 0, 1,-902,871));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-772,-962));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('LINESTRING(83 87,28 56 ,82 70 )',0), 1, 0, 0, 1,316,372));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((66 30,87 34 ,14 64 ,30 58 ,47 6 ,66 30)),((72 55,14 44 ,52 43 ,85 100 ,90 45 ,72 55)),((100 79,25 88 ,8 99 ,17 4 ,66 79 ,100 79)),((51 61,93 30 ,64 14 ,88 57 ,70 34 ,51 61))),LINESTRING(27 10,48 74 ,15 37 ))',0), 1, 0, 0, 1,-86,19));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-64,-989));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOINT((72 93),(59 58),(26 87),(17 87)),POLYGON((15 54,36 80 ,80 5 ,15 54)))',0), 1, 0, 0, 1,-156,867));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_FlipCoordinates(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}