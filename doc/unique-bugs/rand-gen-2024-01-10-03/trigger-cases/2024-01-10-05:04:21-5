{"query1": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(6,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-279,57));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((88 99,69 23 ,16 38 ,18 32 ,56 66 ,88 99)),((84 30,7 78 ,54 4 ,76 94 ,39 99 ,84 30)),((1 79,4 41 ,1 81 ,0 5 ,74 98 ,1 79)))',0), 1, 0, 0, 1,781,50));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('LINESTRING(48 82,48 74 ,76 37 )',0), 1, 0, 0, 1,-419,-545));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING(36 14,46 24 ,96 44 ,36 14)',0), 1, 0, 0, 1,-999,468));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POLYGON((88 93,99 92 ,42 9 ,47 30 ,36 27 ,74 41 ,17 84 ,39 69 ,88 93))',0), 1, 0, 0, 1,927,-784));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,709,-732));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((35 34,48 42 ,47 57 ,53 25 ,36 14 ,35 34)),((92 35,86 42 ,95 31 ,38 5 ,94 87 ,92 35)),((57 35,41 1 ,81 55 ,99 87 ,15 49 ,57 35))),GEOMETRYCOLLECTION EMPTY)',0), 1, 0, 0, 1,704,-154));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PolygonFromText('POLYGON((24 99,18 77 ,2 21 ,22 40 ,54 37 ,62 43 ,70 18 ,24 99))',0), 1, 0, 0, 1,818,-187));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-813,-124));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('POLYGON((68 53,79 81 ,6 31 ,15 41 ,14 77 ,19 42 ,84 57 ,62 89 ,68 53))',0), 1, 0, 0, 1,-521,805));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Multi(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}