{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,997,-568));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT((22 21),(3 29),(37 68),(8 92),(89 98),(28 75),(66 43),(60 49),(7 26),(40 11),(43 51))',0), 1, 0, 0, 1,-4,58));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('LINESTRING(9 63,57 48 ,13 58 ,9 63)',0), 1, 0, 0, 1,550,732));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPointFromText('MULTIPOINT((82 67),(97 49),(79 60),(68 58),(13 58))',0), 1, 0, 0, 1,175,-938));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((21 42,9 46 ,46 94 ,21 42)),((5 41,20 22 ,55 69 ,5 41)),((21 48,23 89 ,24 93 ,21 48)),((85 1,10 31 ,96 43 ,85 1)))',0), 1, 0, 0, 1,451,242));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('LINESTRING(62 81,0 83 ,64 25 )',0), 1, 0, 0, 1,336,773));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('POINT(69 56)',0), 1, 0, 0, 1,-803,-513));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((30 77,49 68 ,49 63 ,30 77)),((68 74,66 55 ,44 62 ,68 74)),((21 93,67 90 ,79 41 ,21 93)),((75 3,39 65 ,29 93 ,75 3)))',0), 1, 0, 0, 1,-642,95));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('POLYGON((25 5,27 46 ,73 70 ,76 71 ,84 89 ,67 14 ,57 29 ,68 2 ,25 5))',0), 1, 0, 0, 1,748,751));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,755,-511));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}