{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-239,-291));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_PointFromText('POINT(4 15)',0), 1, 0, 0, 1,937,466));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MLineFromText('MULTILINESTRING((29 51,93 23 ,64 87 ,29 51), (50 47,87 21 ,92 72 ))',0), 1, 0, 0, 1,-423,985));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-48,-562));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON EMPTY,GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(70 3,52 52 ,38 66 ),MULTIPOINT((13 36))),MULTILINESTRING((27 17,40 60 ,27 17), (20 14,19 4 ,20 14))))',0), 1, 0, 0, 1,716,983));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(POLYGON((38 21,59 75 ,37 94 ,46 34 ,38 21)),LINESTRING(96 59,99 92 ,97 43 ))',0), 1, 0, 0, 1,659,-121));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MLineFromText('MULTILINESTRING((53 15,21 46 ,37 46 ), (71 7,54 5 ,67 37 ,71 7))',0), 1, 0, 0, 1,-729,651));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(MULTIPOINT((94 24)),POINT(9 38)),POINT(42 85))',0), 1, 0, 0, 1,989,36));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('POLYGON((96 48,81 100 ,58 36 ,38 88 ,39 36 ,91 23 ,62 100 ,54 54 ,96 48))',0), 1, 0, 0, 1,963,775));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((43 16,14 78 ,75 21 ,47 49 ,21 63 ,43 16)),((94 96,26 21 ,44 45 ,97 80 ,21 42 ,94 96)),((29 76,79 3 ,86 16 ,83 54 ,29 17 ,29 76)),((40 36,90 54 ,46 8 ,98 95 ,6 48 ,40 36)))',0), 1, 0, 0, 1,932,-740));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET valid = ST_IsValid(geom); "}