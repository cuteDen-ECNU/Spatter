{"query1": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_DWithin(a1.geom, a2.geom, 675)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_DWithin(a1.geom, a2.geom, 675)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(6,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('LINESTRING(44 81,57 17 ,76 0 )',0), 1, 0, 0, 1,-117,334));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,214,925));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-68,568));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('POLYGON((54 69,17 64 ,0 19 ,15 36 ,6 43 ,25 78 ,1 79 ,2 5 ,54 69))',0), 1, 0, 0, 1,-638,-18));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('LINESTRING(60 87,20 18 ,92 29 ,60 87)',0), 1, 0, 0, 1,-892,81));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((88 88,71 38 ,99 90 ,90 19 ,88 88)),((3 63,40 44 ,4 77 ,21 94 ,3 63)),((92 10,52 74 ,29 56 ,63 7 ,92 10)),((62 30,85 52 ,55 76 ,69 65 ,62 30)))',0), 1, 0, 0, 1,639,-134));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((52 11,17 65 ,20 19 ,0 36 ,99 34 ,52 11)),((39 11,28 78 ,3 64 ,44 44 ,70 27 ,39 11)),((33 54,49 25 ,38 57 ,30 25 ,25 98 ,33 54)),((94 21,45 47 ,99 81 ,11 85 ,17 2 ,94 21)))',0), 1, 0, 0, 1,631,556));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(POINT(65 100))',0), 1, 0, 0, 1,-898,620));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(POLYGON EMPTY,MULTIPOINT((74 96),(64 72)))',0), 1, 0, 0, 1,-412,887));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTILINESTRING EMPTY,MULTIPOINT EMPTY)',0), 1, 0, 0, 1,471,-658));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}