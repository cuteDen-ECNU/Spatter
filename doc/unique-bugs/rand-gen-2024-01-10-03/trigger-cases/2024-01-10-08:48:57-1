{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((16 35),(81 77),(22 20),(40 14),(38 31),(60 50),(79 15),(36 74))', 0)), 1, 0, 0, 1,-585,305));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-371,-31));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('POINT(89 76)',0), 1, 0, 0, 1,271,705));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((15 90,62 64 ,16 8 ,88 44 ,9 86 ,15 90)),((32 61,7 2 ,57 3 ,98 53 ,28 98 ,32 61)),((1 22,60 60 ,71 50 ,51 9 ,70 58 ,1 22)))',0), 1, 0, 0, 1,-941,508));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTILINESTRING((49 93,32 33 ,49 93))',0), 1, 0, 0, 1,346,972));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOINT((43 58),(57 6),(87 68),(10 16),(47 85),(53 4),(51 80),(43 25),(42 86),(68 5),(56 20))',0), 1, 0, 0, 1,250,822));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOINT((27 90),(14 58),(100 8),(41 7),(11 26),(22 4),(3 45))',0), 1, 0, 0, 1,42,893));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PointFromText('POINT(10 24)',0), 1, 0, 0, 1,429,359));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((55 82,40 74 ,18 44 ,83 80 ,44 47 ,55 82)),((71 94,7 46 ,25 62 ,100 73 ,44 93 ,71 94)),((61 81,90 74 ,1 82 ,45 55 ,74 1 ,61 81)),((3 38,84 75 ,63 77 ,92 40 ,73 79 ,3 38))),POINT(9 49))',0), 1, 0, 0, 1,42,68));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-861,588));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}