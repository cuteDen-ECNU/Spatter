{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_LineCrossingDirection(a1.geom, a2.geom) > -1          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "None", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_LineCrossingDirection(a1.geom, a2.geom) > -1          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(6,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,868,-996));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((69 41,77 75 ,49 22 ,96 0 ,69 41)),((58 29,18 32 ,1 23 ,87 92 ,58 29)),((31 14,69 94 ,59 34 ,21 56 ,31 14)))',0), 1, 0, 0, 1,582,363));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,713,942));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_LineFromText('LINESTRING(91 40,35 43 ,14 85 ,91 40)',0), 1, 0, 0, 1,-933,-939));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,795,-307));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTILINESTRING((54 52,53 96 ,54 52))',0), 1, 0, 0, 1,-776,-738));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_LineFromText('LINESTRING(29 10,24 34 ,87 80 ,29 10)',0), 1, 0, 0, 1,331,-166));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-721,-507));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((66 33,86 54 ,6 39 ,66 33)),((9 9,5 68 ,88 32 ,9 9)),((35 22,42 0 ,18 88 ,35 22)))',0), 1, 0, 0, 1,-815,-344));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((7 54,86 62 ,83 18 ,98 47 ,7 54)),((25 92,65 85 ,43 47 ,27 98 ,25 92)),((100 19,94 0 ,67 5 ,78 83 ,100 19)),((39 32,0 54 ,95 61 ,73 71 ,39 32))))',0), 1, 0, 0, 1,-262,-116));  DELETE FROM t0 As a1 WHERE ST_IsEmpty(a1.geom) ;  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}