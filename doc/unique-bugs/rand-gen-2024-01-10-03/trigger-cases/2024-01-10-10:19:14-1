{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MLineFromText('MULTILINESTRING((40 44,21 71 ,65 76 ), (41 72,1 99 ,47 94 ,41 72))',0), 1, 0, 0, 1,258,-630));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((47 77),(76 78),(20 8),(83 88))', 0)), 1, 0, 0, 1,-107,424));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((0 24,71 42 ,95 57 ,84 6 ,0 24)),((63 14,92 49 ,52 57 ,83 9 ,63 14)),((82 61,0 74 ,36 32 ,70 60 ,82 61)),((17 61,64 65 ,11 64 ,26 63 ,17 61)))',0), 1, 0, 0, 1,-629,345));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_LineFromText('LINESTRING(63 81,38 68 ,23 17 )',0), 1, 0, 0, 1,-384,-681));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,999,703));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(POINT(28 60),POLYGON((27 68,36 21 ,36 18 ,27 68)))',0), 1, 0, 0, 1,-741,991));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_LineFromText('LINESTRING(88 24,19 79 ,59 24 ,88 24)',0), 1, 0, 0, 1,-587,29));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PointFromText('POINT(83 55)',0), 1, 0, 0, 1,888,0));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-579,-635));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((29 92,47 8 ,59 98 ,65 51 ,46 39 ,29 92)),((69 52,53 24 ,83 56 ,16 64 ,29 80 ,69 52)),((64 6,45 16 ,93 90 ,7 36 ,50 60 ,64 6)),((57 54,12 76 ,87 27 ,75 26 ,44 43 ,57 54)))',0), 1, 0, 0, 1,-793,564));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_RemoveRepeatedPoints(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}