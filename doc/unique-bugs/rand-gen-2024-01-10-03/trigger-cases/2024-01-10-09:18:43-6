{"query1": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-167,-47));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_PolygonFromText('POLYGON((28 49,56 17 ,34 97 ,17 92 ,72 5 ,46 44 ,8 32 ,1 78 ,34 6 ,28 49))',0), 1, 0, 0, 1,311,-764));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((15 49,67 12 ,12 66 ,15 49)),((42 21,40 85 ,11 56 ,42 21)),((68 40,43 73 ,73 13 ,68 40)),((62 6,96 7 ,30 51 ,62 6)))',0), 1, 0, 0, 1,-315,147));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPointFromText('MULTIPOINT((68 37),(74 90),(98 20),(19 56),(84 66),(4 54),(40 76),(68 43),(70 4))',0), 1, 0, 0, 1,365,-500));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((46 11,42 51 ,32 96 ,72 46 ,57 16 ,46 11)),((51 29,66 97 ,0 23 ,81 59 ,49 95 ,51 29)))',0), 1, 0, 0, 1,-52,911));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((75 35,10 54 ,62 0 ,8 93 ,75 35)),((8 82,96 60 ,44 42 ,18 57 ,8 82)),((8 48,77 81 ,12 27 ,100 51 ,8 48)))',0), 1, 0, 0, 1,-564,-463));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPointFromText('MULTIPOINT((45 11),(73 72),(61 77),(47 56),(70 53),(50 20),(65 62),(72 85),(17 90))',0), 1, 0, 0, 1,804,834));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,733,-142));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((21 31),(96 30),(64 49),(47 53),(27 50),(2 97),(82 43),(86 57),(26 41))', 0)), 1, 0, 0, 1,111,55));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_PolygonFromText('POLYGON((83 53,89 97 ,77 20 ,4 18 ,15 94 ,13 66 ,7 31 ,97 67 ,11 77 ,11 38 ,83 53))',0), 1, 0, 0, 1,586,-316));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}