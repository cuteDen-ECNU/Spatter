{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(12,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((85 7,43 10 ,49 98 ,72 55 ,85 7)),((26 73,60 41 ,21 20 ,67 44 ,26 73)))',0), 1, 0, 0, 1,366,-92));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,735,588));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('POINT(94 51)',0), 1, 0, 0, 1,197,-631));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,235,46));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,317,481));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTILINESTRING((3 81,54 12 ))',0), 1, 0, 0, 1,551,-363));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((81 15,32 41 ,64 38 ,58 54 ,23 3 ,81 15)),((6 53,33 1 ,98 57 ,0 59 ,97 21 ,6 53)),((71 80,19 61 ,97 22 ,2 36 ,74 16 ,71 80)),((19 0,8 66 ,67 77 ,50 29 ,44 11 ,19 0)))',0), 1, 0, 0, 1,334,248));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((16 92,43 45 ,4 75 ,91 99 ,87 4 ,16 92)),((4 30,20 9 ,5 23 ,44 86 ,44 97 ,4 30)),((51 72,24 26 ,97 29 ,65 96 ,34 23 ,51 72)),((70 81,70 42 ,12 2 ,8 3 ,69 57 ,70 81)))',0), 1, 0, 0, 1,-891,307));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((64 70,11 22 ,25 29 ,35 58 ,64 70)),((68 48,77 99 ,49 63 ,87 29 ,68 48)),((52 57,91 100 ,26 41 ,70 26 ,52 57)),((50 31,21 16 ,70 93 ,45 51 ,50 31)))',0), 1, 0, 0, 1,294,936));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-215,675));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForcePolygonCW(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}