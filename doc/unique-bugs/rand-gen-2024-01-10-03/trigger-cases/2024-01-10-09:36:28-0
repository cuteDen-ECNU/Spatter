{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_LineFromText('LINESTRING(9 49,3 62 ,38 6 ,9 49)',0), 1, 0, 0, 1,552,-426));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-138,619));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MLineFromText('MULTILINESTRING((93 12,23 24 ,26 16 ,93 12))',0), 1, 0, 0, 1,339,-627));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING(71 28,76 10 ,21 89 )',0), 1, 0, 0, 1,-4,-345));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTILINESTRING((14 3,6 20 ), (23 5,58 79 ))',0), 1, 0, 0, 1,661,597));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT((61 24)),MULTIPOINT EMPTY)',0), 1, 0, 0, 1,-208,52));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTILINESTRING((50 26,49 100 ), (41 35,34 31 ))',0), 1, 0, 0, 1,414,714));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((51 69,25 6 ,66 98 ,77 73 ,23 38 ,51 69)),((13 76,58 0 ,98 100 ,63 51 ,82 52 ,13 76)),((10 74,44 53 ,80 7 ,66 46 ,61 45 ,10 74)),((66 95,78 17 ,39 0 ,93 23 ,96 11 ,66 95)))',0), 1, 0, 0, 1,871,660));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-422,-386));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((71 13,53 10 ,33 59 ,57 60 ,8 54 ,71 13)),((74 45,29 55 ,79 32 ,89 33 ,54 6 ,74 45)),((27 51,88 49 ,79 55 ,100 26 ,45 63 ,27 51)),((5 85,41 99 ,86 53 ,13 16 ,69 40 ,5 85))),MULTILINESTRING((70 7,63 48 ,70 7), (60 76,92 99 )))',0), 1, 0, 0, 1,595,-102));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Multi(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}