{"query1": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_PointFromText('POINT(89 77)',0), 1, 0, 0, 1,838,442));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((100 22,47 23 ,21 93 ,50 78 ,66 93 ,100 22)),((4 55,22 91 ,85 15 ,19 22 ,44 64 ,4 55)),((37 5,42 65 ,33 3 ,69 58 ,35 95 ,37 5)),((27 53,28 29 ,42 40 ,8 21 ,43 30 ,27 53))),POINT(91 59))',0), 1, 0, 0, 1,375,455));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((86 94,100 75 ,48 53 ,94 31 ,32 47 ,86 94)),((38 30,90 38 ,24 61 ,96 8 ,7 8 ,38 30)))',0), 1, 0, 0, 1,-154,861));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MLineFromText('MULTILINESTRING((35 29,57 18 ,35 29), (9 89,87 10 ,9 89))',0), 1, 0, 0, 1,85,606));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTIPOINT((14 65),(90 43))',0), 1, 0, 0, 1,781,-924));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POLYGON((70 33,100 21 ,99 90 ,80 70 ,2 50 ,53 89 ,55 75 ,15 30 ,63 75 ,70 33))',0), 1, 0, 0, 1,791,-306));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,166,-452));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PolygonFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-758,-749));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((37 83,68 68 ,42 53 ,94 12 ,37 83)),((24 68,23 64 ,90 23 ,66 40 ,24 68)),((3 44,71 87 ,19 69 ,72 41 ,3 44)))',0), 1, 0, 0, 1,616,-107));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(MULTILINESTRING((36 85,5 58 ,36 85)),MULTILINESTRING EMPTY),POINT(68 0))',0), 1, 0, 0, 1,-230,-35));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Affine(geom,0, 2, 2, 0, 0, 0);  UPDATE t0 SET geom = ST_Scale(geom, 2, 2);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}