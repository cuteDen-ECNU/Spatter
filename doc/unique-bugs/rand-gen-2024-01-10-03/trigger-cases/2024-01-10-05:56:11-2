{"query1": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-2,-298));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('POINT(8 2)',0), 1, 0, 0, 1,-454,759));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('POLYGON((13 83,94 22 ,66 53 ,13 40 ,89 49 ,23 91 ,95 65 ,95 26 ,13 83))',0), 1, 0, 0, 1,-159,411));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-1000,709));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTIPOINT((15 66),(97 64),(62 4),(51 28),(78 64),(61 2),(28 49),(62 8),(81 67),(13 68))',0), 1, 0, 0, 1,174,-198));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((3 2,35 9 ,99 63 ,68 35 ,27 69 ,3 2)),((25 83,21 37 ,4 16 ,23 100 ,94 58 ,25 83)),((46 75,27 50 ,19 41 ,13 39 ,36 66 ,46 75)),((67 22,98 19 ,53 44 ,11 64 ,76 33 ,67 22)))',0), 1, 0, 0, 1,812,-292));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPointFromText('MULTIPOINT((6 82),(6 37),(77 84),(75 43),(75 44),(83 81),(17 36),(96 82),(15 56))',0), 1, 0, 0, 1,339,387));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PolygonFromText('POLYGON((52 43,61 12 ,87 51 ,14 69 ,62 53 ,53 39 ,85 16 ,7 38 ,52 43))',0), 1, 0, 0, 1,569,-75));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_PointFromText('POINT(30 69)',0), 1, 0, 0, 1,718,980));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('LINESTRING(86 77,9 89 ,67 69 ,86 77)',0), 1, 0, 0, 1,276,930));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Affine(geom,3, 4, 4, -3, 0, 0);  UPDATE t0 SET geom = ST_Scale(geom, 5, 5);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}