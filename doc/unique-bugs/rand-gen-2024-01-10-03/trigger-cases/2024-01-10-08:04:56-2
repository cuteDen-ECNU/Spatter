{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((81 35,64 45 ,59 61 ,58 8 ,81 35)),((19 65,63 2 ,66 26 ,42 90 ,19 65)),((10 70,44 41 ,16 91 ,4 90 ,10 70)),((95 75,80 56 ,83 45 ,83 0 ,95 75)))',0), 1, 0, 0, 1,-941,-478));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('LINESTRING(80 49,76 74 ,70 58 ,80 49)',0), 1, 0, 0, 1,54,773));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MLineFromText('MULTILINESTRING((21 19,25 8 ,21 19))',0), 1, 0, 0, 1,-439,31));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,27,-750));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_PolygonFromText('POLYGON((8 95,100 93 ,83 46 ,96 94 ,0 67 ,2 95 ,84 67 ,61 57 ,5 15 ,91 69 ,8 95))',0), 1, 0, 0, 1,801,-724));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POLYGON((54 72,24 95 ,10 13 ,21 43 ,20 40 ,51 21 ,54 72))',0), 1, 0, 0, 1,871,-24));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((65 84,7 71 ,17 5 ,82 40 ,65 84)),((72 38,10 52 ,1 66 ,70 89 ,72 38)),((33 30,32 29 ,26 47 ,55 63 ,33 30)),((83 5,49 67 ,86 11 ,40 9 ,83 5)))',0), 1, 0, 0, 1,-932,47));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,978,-131));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-320,-625));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('LINESTRING(57 8,67 90 ,48 20 ,57 8)',0), 1, 0, 0, 1,202,483));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForcePolygonCW(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}