{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((9 87,6 46 ,75 13 ,14 71 ,9 87)),((61 71,81 38 ,94 52 ,3 82 ,61 71)))',0), 1, 0, 0, 1,789,638));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_PolygonFromText('POLYGON((99 99,9 27 ,69 44 ,92 9 ,39 48 ,79 86 ,88 71 ,56 82 ,99 99))',0), 1, 0, 0, 1,380,-512));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOINT((100 1),(12 91),(30 36),(80 46))',0), 1, 0, 0, 1,-564,-835));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((87 2,75 24 ,79 47 ,75 60 ,87 2)),((31 91,49 95 ,4 18 ,33 26 ,31 91)),((68 42,94 80 ,66 94 ,56 82 ,68 42)),((71 67,87 25 ,67 99 ,60 86 ,71 67)))',0), 1, 0, 0, 1,-65,-71));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-964,219));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT EMPTY', 0)), 1, 0, 0, 1,-222,173));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_PolygonFromText('POLYGON((18 44,62 79 ,99 74 ,37 71 ,59 28 ,94 69 ,18 44))',0), 1, 0, 0, 1,154,949));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PointFromText('POINT(21 20)',0), 1, 0, 0, 1,100,-304));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_LineFromText('LINESTRING(59 4,83 13 ,2 39 ,59 4)',0), 1, 0, 0, 1,419,-631));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((30 91,32 70 ,8 80 ,3 12 ,14 72 ,30 91)),((75 18,86 41 ,48 74 ,8 64 ,93 49 ,75 18)),((60 37,89 48 ,65 98 ,40 42 ,7 15 ,60 37)),((89 61,82 21 ,100 26 ,3 45 ,22 27 ,89 61)))',0), 1, 0, 0, 1,342,-300));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET valid = ST_IsValid(geom); "}