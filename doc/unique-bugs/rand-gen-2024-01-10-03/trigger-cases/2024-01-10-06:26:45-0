{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((51 17,87 97 ,84 78 ,51 17)),((28 19,43 42 ,6 8 ,28 19)),((97 69,74 41 ,78 91 ,97 69)),((2 25,30 9 ,67 20 ,2 25)))',0), 1, 0, 0, 1,790,580));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT((81 98),(30 37),(27 98),(70 79),(40 88),(47 91),(25 53),(3 17),(14 40),(69 38),(26 1))',0), 1, 0, 0, 1,873,521));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOINT((50 18),(89 98),(14 60),(28 36),(30 56),(6 11),(38 68))',0), 1, 0, 0, 1,775,-600));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MLineFromText('MULTILINESTRING((61 34,1 11 ))',0), 1, 0, 0, 1,-284,-272));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPointFromText('MULTIPOINT((59 32),(72 54),(67 9))',0), 1, 0, 0, 1,-972,-35));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,587,311));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(MULTILINESTRING EMPTY))',0), 1, 0, 0, 1,-355,308));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((55 24,87 36 ,72 78 ,55 24)),((33 21,58 95 ,81 79 ,33 21)),((43 14,76 100 ,27 33 ,43 14)))',0), 1, 0, 0, 1,-582,335));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTILINESTRING((28 72,69 67 ,28 72), (91 1,20 43 )),LINESTRING EMPTY)',0), 1, 0, 0, 1,-229,-765));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(95 89),MULTILINESTRING((4 39,61 33 ,4 39))),MULTILINESTRING((78 38,28 51 ))))',0), 1, 0, 0, 1,-344,743));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Multi(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}