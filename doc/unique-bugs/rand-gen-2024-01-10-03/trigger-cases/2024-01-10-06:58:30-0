{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_LineCrossingDirection(a1.geom, a2.geom) > -3          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_LineCrossingDirection(a1.geom, a2.geom) > -3          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "None", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('LINESTRING(16 71,99 29 ,54 76 )',0), 1, 0, 0, 1,485,-428));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((27 57,55 47 ,67 52 ,27 57)),((92 62,13 22 ,19 98 ,92 62)),((77 48,19 54 ,68 79 ,77 48)),((27 7,55 34 ,51 53 ,27 7)))',0), 1, 0, 0, 1,456,371));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-91,-690));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING(41 31,30 10 ,34 51 )',0), 1, 0, 0, 1,-744,-141));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((10 31,82 21 ,13 32 ,68 84 ,9 34 ,10 31)),((96 75,100 73 ,71 91 ,25 20 ,52 7 ,96 75)),((78 8,28 99 ,60 100 ,83 83 ,2 66 ,78 8)),((77 53,91 31 ,85 14 ,75 9 ,56 20 ,77 53)))',0), 1, 0, 0, 1,-290,998));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,108,247));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MLineFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-585,577));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,584,631));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('LINESTRING(9 94,70 86 ,42 61 )',0), 1, 0, 0, 1,-50,-76));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((99 69,22 80 ,42 36 ,93 57 ,65 21 ,99 69)),((36 14,23 2 ,37 73 ,91 51 ,99 93 ,36 14)),((55 3,27 14 ,70 69 ,42 11 ,82 60 ,55 3)))',0), 1, 0, 0, 1,248,459));  DELETE FROM t0 As a1 WHERE ST_IsEmpty(a1.geom) ;  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Multi(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}