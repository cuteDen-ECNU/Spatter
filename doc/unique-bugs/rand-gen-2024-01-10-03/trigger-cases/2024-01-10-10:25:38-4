{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(6,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPointFromText('MULTIPOINT((16 98),(90 48))',0), 1, 0, 0, 1,99,-738));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((9 83,93 12 ,46 15 ,9 83)),((83 33,92 88 ,72 88 ,83 33)))',0), 1, 0, 0, 1,-138,55));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_LineFromText('LINESTRING(12 29,55 10 ,79 55 )',0), 1, 0, 0, 1,-704,875));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MLineFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-751,-39));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_LineFromText('LINESTRING(52 1,86 88 ,49 36 )',0), 1, 0, 0, 1,-676,766));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,91,-800));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((27 97,16 54 ,50 43 ,45 71 ,36 29 ,27 97)),((63 72,52 65 ,77 0 ,88 26 ,46 43 ,63 72)),((49 15,93 5 ,17 35 ,63 35 ,79 4 ,49 15)))',0), 1, 0, 0, 1,-334,606));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PointFromText('POINT(81 20)',0), 1, 0, 0, 1,267,738));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((56 36,24 24 ,68 99 ,26 79 ,79 91 ,56 36)),((74 61,81 8 ,66 8 ,83 18 ,80 35 ,74 61)),((71 45,56 12 ,5 73 ,20 43 ,0 58 ,71 45)),((35 9,66 21 ,13 16 ,30 18 ,39 49 ,35 9)))',0), 1, 0, 0, 1,-57,-319));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-5,-850));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_RemoveRepeatedPoints(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}