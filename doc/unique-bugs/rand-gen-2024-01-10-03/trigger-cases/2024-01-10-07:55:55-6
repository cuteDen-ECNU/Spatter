{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((77 1,68 10 ,3 57 ,61 63 ,77 1)),((25 62,66 51 ,44 35 ,77 97 ,25 62)),((34 88,39 35 ,27 20 ,67 39 ,34 88)),((77 27,83 98 ,57 6 ,92 42 ,77 27)))',0), 1, 0, 0, 1,863,922));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-889,585));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_PointFromText('POINT(32 66)',0), 1, 0, 0, 1,87,-23));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPointFromText('MULTIPOINT((61 80),(28 14))',0), 1, 0, 0, 1,-71,-684));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT EMPTY', 0)), 1, 0, 0, 1,-719,-328));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-232,-187));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPointFromText('MULTIPOINT((98 28),(48 33),(36 33),(75 39),(40 43),(37 25),(58 75),(63 73),(63 99),(55 82),(86 93))',0), 1, 0, 0, 1,-318,851));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PointFromText('POINT(9 68)',0), 1, 0, 0, 1,-851,-168));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOINT((25 41),(45 79),(14 49),(66 8)),MULTIPOLYGON(((98 42,85 82 ,16 65 ,85 24 ,66 2 ,98 42)),((96 26,68 4 ,2 96 ,4 33 ,99 40 ,96 26)),((14 16,23 12 ,89 25 ,18 5 ,26 32 ,14 16)),((100 14,22 52 ,7 60 ,94 51 ,7 87 ,100 14))))',0), 1, 0, 0, 1,358,-53));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_PolygonFromText('POLYGON((8 37,20 88 ,3 51 ,80 15 ,5 32 ,91 15 ,1 38 ,11 87 ,13 74 ,8 37))',0), 1, 0, 0, 1,815,807));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForcePolygonCCW(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}