{"query1": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOINT((70 42),(38 10),(66 96),(70 65),(98 2),(73 100))',0), 1, 0, 0, 1,998,227));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((73 17,68 11 ,16 21 ,48 9 ,8 28 ,73 17)),((60 58,55 82 ,61 99 ,98 70 ,15 12 ,60 58)),((92 80,32 59 ,82 21 ,61 37 ,32 19 ,92 80)))',0), 1, 0, 0, 1,108,-88));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPointFromText('MULTIPOINT((88 18),(96 51),(75 48),(3 7),(0 28),(40 82),(80 65),(94 34),(30 17))',0), 1, 0, 0, 1,-928,-103));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOINT((74 19),(47 32),(20 72),(26 37),(10 8))',0), 1, 0, 0, 1,321,-399));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTIPOINT((56 90),(63 100),(35 21),(1 90),(29 13),(68 60),(82 49),(24 87),(25 44))',0), 1, 0, 0, 1,378,-988));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((17 39,37 99 ,98 35 ,39 99 ,63 39 ,17 39)),((87 25,19 97 ,37 43 ,92 56 ,53 80 ,87 25)),((95 7,95 44 ,66 6 ,10 3 ,83 51 ,95 7)),((35 16,9 13 ,32 18 ,100 46 ,45 63 ,35 16)))',0), 1, 0, 0, 1,-871,-802));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('LINESTRING(2 64,81 83 ,10 22 )',0), 1, 0, 0, 1,873,-929));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,679,-171));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_PolygonFromText('POLYGON((72 15,3 77 ,14 22 ,32 92 ,5 22 ,77 30 ,88 16 ,69 27 ,10 52 ,72 15))',0), 1, 0, 0, 1,-22,-109));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,386,557));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}