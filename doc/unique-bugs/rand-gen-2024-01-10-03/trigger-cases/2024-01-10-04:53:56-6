{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_PolygonFromText('POLYGON((19 18,35 29 ,6 38 ,27 46 ,81 64 ,19 18))',0), 1, 0, 0, 1,238,-376));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT((39 26),(48 57),(96 66),(31 3),(66 37),(25 77),(54 20),(40 17),(93 55),(13 47),(92 13))',0), 1, 0, 0, 1,763,838));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((64 33,80 67 ,79 37 ,54 27 ,64 33)),((68 22,14 5 ,39 80 ,49 7 ,68 22)),((56 83,72 0 ,63 94 ,37 80 ,56 83))),GEOMETRYCOLLECTION EMPTY)',0), 1, 0, 0, 1,246,-879));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_PolygonFromText('POLYGON((43 86,79 3 ,74 19 ,29 68 ,38 18 ,43 86))',0), 1, 0, 0, 1,959,-136));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POINT(68 56)',0), 1, 0, 0, 1,-196,887));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((8 47,77 10 ,14 90 ,79 44 ,8 47)),((27 61,86 61 ,8 13 ,61 68 ,27 61)))',0), 1, 0, 0, 1,-304,-122));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_PolygonFromText('POLYGON((42 13,28 66 ,63 60 ,42 76 ,42 13))',0), 1, 0, 0, 1,439,-234));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-584,56));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPointFromText('MULTIPOINT((46 32),(76 95),(63 6),(72 5),(24 66),(68 24),(38 60),(96 8),(15 31),(7 2),(92 29))',0), 1, 0, 0, 1,-144,-251));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,32,-471));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}