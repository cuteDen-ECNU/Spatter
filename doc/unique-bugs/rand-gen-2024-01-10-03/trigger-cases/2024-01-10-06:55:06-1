{"query1": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((76 73,47 67 ,97 99 ,31 53 ,82 24 ,76 73)),((14 80,39 100 ,77 26 ,61 49 ,30 74 ,14 80)))',0), 1, 0, 0, 1,-202,854));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((85 77,44 38 ,68 1 ,85 77)),((71 38,14 16 ,88 60 ,71 38))),MULTIPOINT((53 90),(19 94),(52 73)))',0), 1, 0, 0, 1,233,253));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-356,676));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING(32 0,80 34 ,31 69 )',0), 1, 0, 0, 1,677,775));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-510,812));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(LINESTRING(60 60,11 89 ,92 75 ,80 92 ,0 21 ,60 60),MULTIPOINT((50 40),(42 22),(83 19),(37 39)))',0), 1, 0, 0, 1,709,467));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT((74 12),(89 52)))',0), 1, 0, 0, 1,526,258));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('LINESTRING(65 76,58 58 ,36 3 )',0), 1, 0, 0, 1,-448,820));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((10 79,15 60 ,20 13 ,30 84 ,31 53 ,10 79)),((54 22,28 66 ,6 74 ,7 95 ,89 81 ,54 22)),((34 83,47 34 ,96 18 ,50 71 ,58 40 ,34 83)),((83 24,50 9 ,61 73 ,46 7 ,43 76 ,83 24)))',0), 1, 0, 0, 1,-363,-933));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((14 8,99 84 ,97 55 ,70 68 ,14 8)),((34 48,87 13 ,28 29 ,93 74 ,34 48)),((30 3,53 87 ,0 19 ,70 56 ,30 3)),((22 5,92 49 ,48 70 ,80 15 ,22 5)))',0), 1, 0, 0, 1,-617,797));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Normalize(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}