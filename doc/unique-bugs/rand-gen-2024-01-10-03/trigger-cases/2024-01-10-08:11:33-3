{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-409,899));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-84,699));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((90 19,37 55 ,4 34 ,56 58 ,38 1 ,90 19)),((49 40,28 64 ,75 84 ,54 81 ,72 45 ,49 40)),((62 79,17 84 ,0 66 ,57 15 ,34 4 ,62 79)))',0), 1, 0, 0, 1,-840,13));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOINT((23 14),(68 74))',0), 1, 0, 0, 1,469,319));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT((32 59),(30 65),(88 53),(12 73)))',0), 1, 0, 0, 1,-413,-79));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((38 80),(80 56),(56 84),(90 59),(49 45),(34 87),(83 37),(58 77))', 0)), 1, 0, 0, 1,78,40));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((99 14,30 98 ,66 56 ,53 77 ,20 63 ,99 14)),((97 62,88 79 ,62 25 ,5 85 ,99 12 ,97 62)))',0), 1, 0, 0, 1,-199,-313));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((62 23,4 37 ,82 2 ,18 30 ,62 23)),((76 13,80 18 ,40 88 ,80 47 ,76 13)),((68 97,65 74 ,68 71 ,98 89 ,68 97)),((77 18,32 57 ,41 14 ,55 4 ,77 18)))',0), 1, 0, 0, 1,-627,-169));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('POINT(55 36)',0), 1, 0, 0, 1,92,-778));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-924,757));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForceCollection(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}