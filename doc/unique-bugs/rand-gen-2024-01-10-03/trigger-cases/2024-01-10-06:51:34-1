{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,864,-656));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT EMPTY', 0)), 1, 0, 0, 1,-312,-444));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('POINT(100 64)',0), 1, 0, 0, 1,669,-851));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('POLYGON((4 29,39 47 ,49 8 ,1 63 ,25 8 ,74 2 ,61 31 ,36 0 ,5 64 ,4 29))',0), 1, 0, 0, 1,-696,-790));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTILINESTRING((19 29,26 3 ,47 85 ,19 29), (10 20,63 33 ,2 78 ))',0), 1, 0, 0, 1,-935,-352));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTILINESTRING((5 73,42 20 ,5 73), (97 49,70 89 ,97 49))',0), 1, 0, 0, 1,-61,-296));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_PointFromText('POINT(22 77)',0), 1, 0, 0, 1,-421,100));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('LINESTRING(89 98,34 9 ,55 23 ,89 98)',0), 1, 0, 0, 1,-214,637));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_LineFromText('LINESTRING(90 75,18 82 ,38 70 ,90 75)',0), 1, 0, 0, 1,433,968));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((12 88,98 52 ,48 73 ,13 56 ,51 91 ,12 88)),((18 33,48 40 ,31 6 ,96 83 ,47 55 ,18 33)),((83 29,55 46 ,61 32 ,39 18 ,82 73 ,83 29)),((61 57,52 45 ,27 14 ,36 5 ,38 44 ,61 57)))',0), 1, 0, 0, 1,185,834));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET valid = ST_IsValid(geom); "}