{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((63 86,80 61 ,41 21 ,54 48 ,63 86)),((8 46,7 71 ,82 79 ,11 78 ,8 46)),((2 8,71 30 ,70 25 ,41 89 ,2 8)))',0), 1, 0, 0, 1,711,-829));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((70 6,87 63 ,57 33 ,1 15 ,70 6)),((16 75,55 85 ,6 15 ,62 86 ,16 75)),((1 84,93 92 ,23 58 ,74 7 ,1 84)))',0), 1, 0, 0, 1,966,-734));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPointFromText('MULTIPOINT((93 50),(64 29),(83 9),(35 61),(53 32))',0), 1, 0, 0, 1,109,836));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,746,402));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((43 12),(8 84))', 0)), 1, 0, 0, 1,597,508));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTILINESTRING((38 52,74 13 ), (100 78,72 12 ))',0), 1, 0, 0, 1,855,-732));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-72,-322));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPointFromText('MULTIPOINT((33 65),(31 41),(87 30),(37 21),(78 52),(97 61),(44 48),(89 14),(73 91))',0), 1, 0, 0, 1,-816,-715));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((25 6,68 62 ,1 64 ,25 6)),((81 65,39 33 ,26 34 ,81 65)),((35 100,88 27 ,49 74 ,35 100)),((90 82,61 41 ,97 65 ,90 82))))',0), 1, 0, 0, 1,-771,614));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_PointFromText('POINT(19 89)',0), 1, 0, 0, 1,491,320));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForcePolygonCW(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}