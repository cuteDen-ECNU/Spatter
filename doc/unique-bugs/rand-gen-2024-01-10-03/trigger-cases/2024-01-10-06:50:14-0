{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('POINT(90 6)',0), 1, 0, 0, 1,653,-15));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_PolygonFromText('POLYGON((19 98,51 64 ,85 88 ,1 58 ,45 49 ,32 85 ,37 5 ,65 39 ,19 98))',0), 1, 0, 0, 1,251,275));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_PolygonFromText('POLYGON((17 97,68 88 ,35 76 ,26 33 ,60 40 ,40 4 ,37 31 ,17 97))',0), 1, 0, 0, 1,100,141));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('POINT(93 43)',0), 1, 0, 0, 1,260,429));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-861,-851));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,348,834));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((29 8,34 39 ,20 75 ,29 8)),((84 23,42 98 ,71 57 ,84 23)),((26 28,33 35 ,91 81 ,26 28)),((43 93,92 76 ,97 59 ,43 93)))',0), 1, 0, 0, 1,736,-142));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(POLYGON EMPTY,LINESTRING(79 95,31 69 ,32 2 ,87 52 ,79 95))',0), 1, 0, 0, 1,409,-43));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(LINESTRING(68 42,9 23 ,27 12 ,68 42),MULTIPOLYGON(((80 11,66 70 ,0 58 ,62 52 ,4 13 ,80 11)),((68 98,77 47 ,68 19 ,22 56 ,44 72 ,68 98)),((10 49,77 82 ,98 60 ,14 22 ,10 14 ,10 49)),((84 64,30 99 ,40 63 ,43 29 ,23 35 ,84 64))))',0), 1, 0, 0, 1,-268,-650));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MLineFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,495,-615));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Affine(geom,3, 4, 4, -3, 0, 0);  UPDATE t0 SET geom = ST_Scale(geom, 5, 5);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}