{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-497,-999));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((79 5,52 52 ,17 42 ,74 70 ,41 36 ,79 5)),((6 85,11 59 ,66 47 ,72 54 ,22 22 ,6 85)),((88 70,21 85 ,85 21 ,80 79 ,8 25 ,88 70)),((75 61,18 63 ,80 48 ,10 76 ,97 71 ,75 61)))',0), 1, 0, 0, 1,-654,346));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((94 49,48 90 ,8 15 ,88 77 ,69 75 ,94 49)),((79 3,3 13 ,15 89 ,59 29 ,55 83 ,79 3)),((21 92,83 44 ,31 43 ,9 57 ,29 76 ,21 92)),((46 94,41 80 ,87 90 ,36 20 ,78 5 ,46 94)))',0), 1, 0, 0, 1,342,929));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('POINT(13 35)',0), 1, 0, 0, 1,716,-470));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 54),MULTIPOLYGON(((66 45,27 61 ,48 73 ,19 12 ,38 40 ,66 45)),((81 75,7 60 ,41 99 ,95 91 ,81 16 ,81 75)),((29 0,84 13 ,87 96 ,62 2 ,86 2 ,29 0)),((75 17,83 97 ,8 7 ,18 64 ,76 6 ,75 17))))',0), 1, 0, 0, 1,-910,515));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POINT(31 47)',0), 1, 0, 0, 1,-429,40));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_PolygonFromText('POLYGON((56 97,70 15 ,91 57 ,28 35 ,0 48 ,17 21 ,30 70 ,20 44 ,17 85 ,43 3 ,56 97))',0), 1, 0, 0, 1,271,-400));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-341,-89));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOINT((49 60),(91 20),(65 83),(72 94),(15 16),(53 39),(23 80))',0), 1, 0, 0, 1,-480,-500));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MLineFromText('MULTILINESTRING((59 59,7 21 ,23 90 ))',0), 1, 0, 0, 1,243,-509));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForceCollection(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}