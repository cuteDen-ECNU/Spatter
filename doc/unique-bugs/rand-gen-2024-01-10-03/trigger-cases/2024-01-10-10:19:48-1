{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-765,-213));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('POLYGON((35 38,31 83 ,58 96 ,12 63 ,28 62 ,100 24 ,60 85 ,66 38 ,35 38))',0), 1, 0, 0, 1,385,-467));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-34,-936));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((26 20,83 14 ,80 43 ,84 19 ,34 60 ,26 20)),((80 95,90 12 ,61 100 ,72 53 ,10 74 ,80 95)))',0), 1, 0, 0, 1,-309,-450));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_LineFromText('LINESTRING(11 33,52 3 ,100 6 )',0), 1, 0, 0, 1,782,-415));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((2 55,24 58 ,1 95 ,98 59 ,17 23 ,2 55)),((97 54,78 25 ,28 41 ,5 81 ,88 5 ,97 54)),((90 4,32 27 ,39 78 ,84 22 ,50 47 ,90 4)))',0), 1, 0, 0, 1,-509,448));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((48 78,76 20 ,54 37 ,2 69 ,74 11 ,48 78)),((56 46,72 49 ,31 61 ,83 85 ,86 80 ,56 46)))',0), 1, 0, 0, 1,893,-489));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTILINESTRING((86 82,84 80 ), (63 79,58 73 ,63 79))',0), 1, 0, 0, 1,481,-593));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOINT((74 27),(32 26),(21 13),(92 52),(77 16),(75 70),(24 30),(4 41))',0), 1, 0, 0, 1,-274,-110));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_PointFromText('POINT(88 79)',0), 1, 0, 0, 1,-316,250));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET valid = ST_IsValid(geom); "}