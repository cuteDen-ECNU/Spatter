{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-31,853));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('POLYGON((61 73,82 8 ,11 16 ,33 69 ,81 3 ,59 58 ,48 13 ,3 42 ,38 5 ,61 73))',0), 1, 0, 0, 1,-228,-774));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((73 58,63 2 ,61 87 ,42 30 ,73 58)),((8 97,100 73 ,28 57 ,30 80 ,8 97)),((9 16,67 16 ,3 3 ,87 60 ,9 16)),((21 61,23 27 ,42 85 ,69 14 ,21 61))),POINT(75 12))',0), 1, 0, 0, 1,48,748));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_LineFromText('LINESTRING(48 23,85 43 ,35 75 )',0), 1, 0, 0, 1,903,55));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((49 67),(75 22),(16 48),(55 39),(1 30),(39 55),(63 6),(50 67),(94 21),(24 58))', 0)), 1, 0, 0, 1,-265,703));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPointFromText('MULTIPOINT((47 56),(58 99),(80 34),(0 40),(38 71),(83 87),(87 37),(12 88),(84 98))',0), 1, 0, 0, 1,-590,764));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((4 6,34 0 ,9 76 ,17 32 ,30 71 ,4 6)),((56 86,78 13 ,28 4 ,74 22 ,46 84 ,56 86)))',0), 1, 0, 0, 1,-70,526));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('LINESTRING(53 51,37 41 ,59 19 ,53 51)',0), 1, 0, 0, 1,665,254));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MLineFromText('MULTILINESTRING((27 56,95 15 ,78 9 ,27 56), (28 91,90 1 ,51 16 ,28 91))',0), 1, 0, 0, 1,-289,649));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-49,-52));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_FlipCoordinates(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}