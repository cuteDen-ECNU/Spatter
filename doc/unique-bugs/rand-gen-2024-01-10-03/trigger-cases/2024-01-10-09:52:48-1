{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING EMPTY,MULTILINESTRING EMPTY)',0), 1, 0, 0, 1,-577,-205));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((71 26,59 18 ,13 2 ,71 26)),((66 58,67 90 ,65 24 ,66 58)),((68 62,41 63 ,5 75 ,68 62)),((42 0,34 22 ,96 57 ,42 0)))',0), 1, 0, 0, 1,997,535));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((70 29,94 66 ,90 39 ,8 7 ,48 54 ,70 29)),((89 73,79 41 ,83 6 ,94 35 ,7 15 ,89 73)))',0), 1, 0, 0, 1,418,610));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((15 56,41 60 ,68 59 ,15 56)),((61 1,29 2 ,14 85 ,61 1)),((4 6,47 96 ,55 98 ,4 6)))',0), 1, 0, 0, 1,-771,167));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,890,-613));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POLYGON((96 31,88 86 ,95 95 ,42 14 ,96 31))',0), 1, 0, 0, 1,-747,-92));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MLineFromText('MULTILINESTRING((68 49,83 84 ), (1 98,26 59 ))',0), 1, 0, 0, 1,-708,477));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PolygonFromText('POLYGON((37 10,42 75 ,87 82 ,95 100 ,76 14 ,13 2 ,34 88 ,37 10))',0), 1, 0, 0, 1,177,-601));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((71 69,74 55 ,21 40 ,53 95 ,48 19 ,71 69)),((79 72,41 82 ,88 2 ,80 100 ,72 63 ,79 72)),((85 86,29 64 ,80 100 ,26 70 ,7 91 ,85 86)),((24 9,19 6 ,39 72 ,69 35 ,32 93 ,24 9)))',0), 1, 0, 0, 1,-272,-527));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPointFromText('MULTIPOINT((0 15))',0), 1, 0, 0, 1,869,-386));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Multi(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}