{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_LineFromText('LINESTRING(5 39,9 3 ,71 26 )',0), 1, 0, 0, 1,-910,882));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(POLYGON((24 6,96 70 ,94 32 ,30 73 ,24 6)),POINT(36 87))',0), 1, 0, 0, 1,966,-112));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTILINESTRING((6 52,81 2 ))',0), 1, 0, 0, 1,-693,304));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-832,723));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((3 63,28 29 ,96 80 ,30 2 ,3 63)),((29 20,47 92 ,52 87 ,83 56 ,29 20)),((38 72,98 14 ,84 93 ,40 66 ,38 72)),((11 96,42 28 ,59 62 ,41 23 ,11 96)))',0), 1, 0, 0, 1,834,683));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOINT((26 55),(100 32),(16 31),(41 27),(19 91),(89 27),(47 4),(2 46),(61 100))',0), 1, 0, 0, 1,-418,356));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((17 10,65 90 ,89 7 ,17 10)),((89 31,84 13 ,31 20 ,89 31)),((21 76,69 60 ,59 51 ,21 76)))',0), 1, 0, 0, 1,-555,940));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,820,923));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTILINESTRING((87 50,55 87 ,99 82 ))',0), 1, 0, 0, 1,-629,-857));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((43 8,1 31 ,52 40 ,88 18 ,53 15 ,43 8)),((74 6,37 17 ,92 43 ,46 51 ,25 55 ,74 6)),((35 65,39 7 ,71 25 ,89 19 ,91 2 ,35 65)),((94 45,5 73 ,92 14 ,79 22 ,61 92 ,94 45)))',0), 1, 0, 0, 1,449,480));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_RemoveRepeatedPoints(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}