{"query1": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MLineFromText('MULTILINESTRING((77 21,72 41 ,77 21), (98 62,98 68 ))',0), 1, 0, 0, 1,-665,-629));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT((0 8),(92 55),(20 76),(10 70),(47 98),(58 34),(79 19),(15 6),(23 53),(47 64),(30 41))',0), 1, 0, 0, 1,466,3));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTILINESTRING((92 68,93 0 ,62 82 ))',0), 1, 0, 0, 1,-937,946));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('POLYGON((9 68,43 37 ,74 17 ,77 69 ,75 19 ,9 68))',0), 1, 0, 0, 1,495,501));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-830,736));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('LINESTRING(21 77,70 78 ,20 37 ,21 77)',0), 1, 0, 0, 1,-816,146));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((1 8,35 2 ,70 71 ,74 10 ,26 28 ,1 8)),((41 47,68 21 ,9 70 ,34 87 ,5 69 ,41 47)),((53 8,68 98 ,45 99 ,90 70 ,71 31 ,53 8)),((25 86,33 60 ,80 3 ,0 0 ,36 42 ,25 86)))',0), 1, 0, 0, 1,-829,-595));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((88 17,66 41 ,59 11 ,88 17)),((64 43,79 99 ,30 93 ,64 43)))',0), 1, 0, 0, 1,805,172));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,515,-304));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MLineFromText('MULTILINESTRING((37 17,46 39 ,37 17), (74 41,58 48 ))',0), 1, 0, 0, 1,-699,237));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForcePolygonCCW(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}