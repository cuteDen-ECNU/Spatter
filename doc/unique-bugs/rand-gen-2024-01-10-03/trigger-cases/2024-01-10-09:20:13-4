{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_LineFromText('LINESTRING(97 86,84 33 ,12 47 )',0), 1, 0, 0, 1,-489,-660));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((95 25),(22 55),(63 48),(49 8),(12 14),(83 14),(41 82),(76 51),(51 69),(88 35),(35 6))', 0)), 1, 0, 0, 1,-144,-566));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-326,549));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((64 79,20 67 ,39 28 ,98 91 ,81 79 ,64 79)),((66 94,1 63 ,4 98 ,60 91 ,10 63 ,66 94)),((35 100,5 25 ,97 63 ,53 91 ,14 80 ,35 100)))',0), 1, 0, 0, 1,-567,-640));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPointFromText('MULTIPOINT((1 79),(54 22),(16 74),(38 88),(18 66),(59 9),(39 60),(66 9))',0), 1, 0, 0, 1,212,-608));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(MULTIPOINT((32 19),(85 0),(89 45)),POINT(38 36)),POLYGON((50 96,8 13 ,70 63 ,50 96)))',0), 1, 0, 0, 1,-57,-885));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-19,400));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOINT((20 95),(95 33),(56 60),(47 15),(80 45),(20 9),(61 75))',0), 1, 0, 0, 1,250,-179));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((11 68,73 2 ,91 19 ,63 16 ,51 11 ,11 68)),((55 53,38 5 ,19 14 ,67 72 ,85 68 ,55 53)),((15 59,26 89 ,43 94 ,35 66 ,89 92 ,15 59)))',0), 1, 0, 0, 1,-866,721));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOINT((19 93),(97 7),(60 54),(1 97),(89 29),(13 15),(80 62))',0), 1, 0, 0, 1,-344,285));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForceCollection(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}