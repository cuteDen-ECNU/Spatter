{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_DWithin(a1.geom, a2.geom, 638)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(8,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_DWithin(a1.geom, a2.geom, 638)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(10,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(POINT(51 6))',0), 1, 0, 0, 1,215,-703));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_PointFromText('POINT(58 31)',0), 1, 0, 0, 1,-646,817));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((82 55,10 29 ,43 38 ,77 12 ,44 9 ,82 55)),((6 4,54 0 ,54 17 ,87 84 ,97 7 ,6 4)),((40 41,99 2 ,68 36 ,68 77 ,36 59 ,40 41)),((4 27,20 29 ,93 51 ,60 0 ,53 84 ,4 27)))',0), 1, 0, 0, 1,937,902));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MLineFromText('MULTILINESTRING((60 45,83 11 ), (9 15,21 67 ,9 15))',0), 1, 0, 0, 1,568,-393));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(POLYGON((90 99,69 71 ,15 10 ,47 18 ,90 99)))',0), 1, 0, 0, 1,-228,-182));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT((2 60)),MULTIPOLYGON(((52 5,43 70 ,54 4 ,85 24 ,52 5)),((1 42,45 8 ,19 77 ,68 25 ,1 42))))',0), 1, 0, 0, 1,621,-532));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT EMPTY,GEOMETRYCOLLECTION(LINESTRING(79 33,97 35 ,98 54 ,79 33),MULTIPOINT((4 50),(21 94),(21 22))))',0), 1, 0, 0, 1,-303,-644));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PointFromText('POINT(71 25)',0), 1, 0, 0, 1,943,-689));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((53 11,10 70 ,11 20 ,53 11)),((26 23,6 61 ,41 65 ,26 23)),((41 74,4 96 ,91 66 ,41 74)),((8 5,20 57 ,23 87 ,8 5)))',0), 1, 0, 0, 1,-330,-435));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((95 25))', 0)), 1, 0, 0, 1,-557,875));  DELETE FROM t0 As a1 WHERE ST_IsEmpty(a1.geom) ;  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}