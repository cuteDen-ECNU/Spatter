{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_PointFromText('POINT(53 90)',0), 1, 0, 0, 1,-684,447));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,858,-526));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((97 25,92 12 ,10 19 ,5 74 ,97 25)),((52 63,71 22 ,94 58 ,67 67 ,52 63)),((84 77,19 86 ,13 36 ,64 20 ,84 77)),((66 99,35 29 ,77 10 ,7 58 ,66 99)))',0), 1, 0, 0, 1,22,114));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-438,-584));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTIPOINT((0 52),(100 35),(98 41),(81 84))',0), 1, 0, 0, 1,-72,-897));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((73 37,81 73 ,76 24 ,73 37)),((85 56,21 47 ,95 21 ,85 56)),((42 78,76 59 ,76 95 ,42 78)),((20 32,97 73 ,97 66 ,20 32)))',0), 1, 0, 0, 1,376,780));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((55 66,92 8 ,79 76 ,55 66)),((26 97,72 26 ,41 6 ,26 97)),((9 84,93 46 ,53 71 ,9 84)),((5 89,80 88 ,20 73 ,5 89)))',0), 1, 0, 0, 1,-143,-318));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOINT((86 30),(96 64),(76 91),(92 87),(62 16),(20 89),(61 71),(17 46),(89 7),(37 70))',0), 1, 0, 0, 1,498,-955));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('POLYGON((83 3,20 17 ,93 72 ,79 56 ,64 15 ,64 86 ,36 14 ,83 3))',0), 1, 0, 0, 1,-566,-639));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('POINT(13 40)',0), 1, 0, 0, 1,574,798));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}