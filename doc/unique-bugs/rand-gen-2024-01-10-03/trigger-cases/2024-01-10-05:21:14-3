{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(12,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('LINESTRING(59 47,69 61 ,18 14 )',0), 1, 0, 0, 1,863,314));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((19 40),(57 73),(95 65),(46 70),(46 45),(16 4),(14 14),(60 53),(16 87),(42 20),(34 15))', 0)), 1, 0, 0, 1,585,47));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('LINESTRING(45 99,25 76 ,54 56 )',0), 1, 0, 0, 1,390,-815));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,504,475));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,748,-795));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((98 41,21 31 ,10 44 ,98 41)),((69 57,97 18 ,22 29 ,69 57)),((97 90,12 43 ,0 56 ,97 90)),((48 11,66 14 ,2 88 ,48 11)))',0), 1, 0, 0, 1,396,743));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((31 9,68 66 ,4 38 ,31 9)),((64 10,55 25 ,13 64 ,64 10)),((63 83,82 32 ,77 63 ,63 83)),((54 54,20 37 ,28 34 ,54 54)))',0), 1, 0, 0, 1,133,-873));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((91 3,63 9 ,71 51 ,61 34 ,52 7 ,91 3)),((12 72,70 77 ,46 4 ,37 67 ,74 28 ,12 72)),((32 58,16 59 ,63 44 ,65 29 ,24 86 ,32 58)))',0), 1, 0, 0, 1,-425,446));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-739,-942));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_PolygonFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-411,-987));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}