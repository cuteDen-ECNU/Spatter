{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION EMPTY)',0), 1, 0, 0, 1,656,-619));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((75 75,4 98 ,61 43 ,28 87 ,100 79 ,75 75)),((11 98,98 43 ,43 23 ,22 32 ,91 31 ,11 98)),((7 25,11 15 ,87 62 ,60 67 ,20 82 ,7 25)))',0), 1, 0, 0, 1,582,-89));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((8 3),(95 33),(34 20),(56 76),(53 25),(39 34),(49 37),(30 92))', 0)), 1, 0, 0, 1,-969,-482));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING(59 51,4 43 ,47 26 ,59 51)',0), 1, 0, 0, 1,-360,-228));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(POLYGON((58 94,61 33 ,3 28 ,58 94)),LINESTRING(80 7,81 12 ,24 40 ,84 62 ,80 7))',0), 1, 0, 0, 1,199,387));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTILINESTRING((46 74,54 100 ,80 47 ,46 74), (62 75,98 63 ,42 24 ,62 75))',0), 1, 0, 0, 1,-988,-321));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPointFromText('MULTIPOINT((65 23),(96 88),(96 55),(64 11),(25 53),(9 42),(86 54),(35 75),(69 60),(76 44),(83 55))',0), 1, 0, 0, 1,913,-261));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MLineFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-198,47));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,870,-648));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((12 77,77 61 ,98 51 ,28 4 ,8 13 ,12 77)),((68 48,96 57 ,89 18 ,78 47 ,78 97 ,68 48)),((46 86,84 26 ,62 65 ,14 24 ,67 29 ,46 86)))',0), 1, 0, 0, 1,435,297));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Multi(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}