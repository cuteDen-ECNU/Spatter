{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPointFromText('MULTIPOINT((66 18),(94 46),(36 75),(74 6))',0), 1, 0, 0, 1,880,-935));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPointFromText('MULTIPOINT((33 37),(38 56))',0), 1, 0, 0, 1,293,-729));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((32 83,91 23 ,36 86 ,29 86 ,32 83)),((54 16,28 64 ,94 86 ,48 4 ,54 16)),((98 18,10 2 ,72 10 ,12 7 ,98 18)))',0), 1, 0, 0, 1,395,241));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPointFromText('MULTIPOINT((57 28),(58 25),(91 28),(23 54),(77 15),(8 76),(1 61),(61 86),(7 45),(14 13))',0), 1, 0, 0, 1,-993,620));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-289,776));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((51 68,88 87 ,59 25 ,29 57 ,51 68)),((6 86,64 99 ,5 63 ,14 78 ,6 86)),((86 80,78 52 ,84 38 ,70 85 ,86 80)),((91 43,22 72 ,43 42 ,41 59 ,91 43)))',0), 1, 0, 0, 1,788,219));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((56 36,92 86 ,63 49 ,56 36)),((90 93,57 78 ,70 71 ,90 93)),((36 85,48 1 ,0 13 ,36 85)))',0), 1, 0, 0, 1,-135,-101));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-407,-208));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((50 85,97 75 ,24 58 ,86 51 ,50 85)),((92 58,10 41 ,45 74 ,88 67 ,92 58)))',0), 1, 0, 0, 1,634,-39));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MLineFromText('MULTILINESTRING((4 11,28 46 ,4 11))',0), 1, 0, 0, 1,-18,-360));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForceCollection(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}