{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((40 68,40 98 ,34 73 ,40 68)),((34 55,76 65 ,43 91 ,34 55)),((33 48,19 58 ,95 27 ,33 48)))',0), 1, 0, 0, 1,-624,957));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT EMPTY', 0)), 1, 0, 0, 1,-350,-65));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('POINT(53 28)',0), 1, 0, 0, 1,628,-303));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING(55 91,64 52 ,30 40 )',0), 1, 0, 0, 1,-918,-483));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_PointFromText('POINT(100 28)',0), 1, 0, 0, 1,-85,206));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POINT(58 6)',0), 1, 0, 0, 1,-135,-118));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-995,518));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PolygonFromText('POLYGON((30 8,18 32 ,77 93 ,74 63 ,47 73 ,16 65 ,72 16 ,64 60 ,66 87 ,75 33 ,30 8))',0), 1, 0, 0, 1,-414,-805));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((45 98,18 81 ,9 55 ,45 98)),((37 14,86 64 ,15 55 ,37 14)))',0), 1, 0, 0, 1,507,-876));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((62 37,86 6 ,52 83 ,26 2 ,4 12 ,62 37)),((42 29,31 40 ,18 54 ,89 50 ,45 89 ,42 29)),((15 24,41 15 ,68 61 ,91 96 ,47 74 ,15 24)),((82 71,1 90 ,28 35 ,52 66 ,78 56 ,82 71)))',0), 1, 0, 0, 1,847,95));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}