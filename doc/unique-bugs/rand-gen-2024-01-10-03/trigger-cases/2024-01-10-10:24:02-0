{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,-869,-662));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((53 77,63 83 ,52 12 ,53 77)),((79 63,53 53 ,29 98 ,79 63)),((58 48,79 92 ,21 10 ,58 48)),((53 35,77 48 ,46 64 ,53 35)))',0), 1, 0, 0, 1,36,-519));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((18 6),(86 7),(83 28),(78 83),(38 86),(24 33),(36 87),(38 67))', 0)), 1, 0, 0, 1,-950,-661));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(MULTILINESTRING((49 73,22 85 ), (11 8,96 52 ,11 8)),LINESTRING(36 90,5 25 ,11 15 )),POINT(68 30)))',0), 1, 0, 0, 1,990,-143));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POINT(86 80)',0), 1, 0, 0, 1,799,642));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((33 53,9 94 ,36 65 ,61 17 ,33 53)),((39 4,39 45 ,48 73 ,8 1 ,39 4)),((85 82,88 10 ,45 4 ,85 72 ,85 82)))',0), 1, 0, 0, 1,233,900));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_PolygonFromText('POLYGON((96 23,64 40 ,4 17 ,92 49 ,80 79 ,52 56 ,44 13 ,38 82 ,96 23))',0), 1, 0, 0, 1,-717,-347));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOINT EMPTY,MULTIPOINT EMPTY)',0), 1, 0, 0, 1,495,421));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_PointFromText('POINT(22 99)',0), 1, 0, 0, 1,17,134));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPointFromText('MULTIPOINT((49 98))',0), 1, 0, 0, 1,-383,-852));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForceCollection(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}