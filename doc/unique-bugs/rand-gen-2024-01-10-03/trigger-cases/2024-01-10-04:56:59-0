{"query1": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(2,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((79 51,61 23 ,65 95 ,84 17 ,67 61 ,79 51)),((48 25,95 30 ,65 37 ,23 100 ,30 56 ,48 25)),((4 49,79 60 ,38 78 ,79 22 ,17 73 ,4 49)),((97 98,3 6 ,100 47 ,94 33 ,39 13 ,97 98)))',0), 1, 0, 0, 1,-658,-478));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTILINESTRING((39 82,53 74 ), (88 2,4 42 ,88 2))',0), 1, 0, 0, 1,-925,680));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-849,631));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING((89 37,73 58 )),MULTILINESTRING((44 61,40 94 )))',0), 1, 0, 0, 1,262,973));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((75 85,34 24 ,86 35 ,75 85)),((64 14,93 77 ,59 83 ,64 14)))',0), 1, 0, 0, 1,-511,-162));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POINT(47 43)',0), 1, 0, 0, 1,-377,801));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((70 56,98 98 ,21 97 ,70 56)),((11 28,30 58 ,30 62 ,11 28)),((3 99,85 9 ,94 4 ,3 99)))',0), 1, 0, 0, 1,946,654));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,875,403));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOINT((15 68),(68 48),(17 59),(58 10),(86 15),(65 16),(73 6),(81 89),(4 72),(83 14))',0), 1, 0, 0, 1,179,-398));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((86 79,44 58 ,69 30 ,72 19 ,86 79)),((41 23,30 68 ,99 5 ,4 94 ,41 23)),((8 21,80 88 ,37 77 ,47 53 ,8 21)))',0), 1, 0, 0, 1,-775,819));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Affine(geom,0, 2, 2, 0, 0, 0);  UPDATE t0 SET geom = ST_Scale(geom, 2, 2);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}