{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_LineFromText('LINESTRING(65 55,10 45 ,1 35 )',0), 1, 0, 0, 1,753,745));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_LineFromText('LINESTRING(42 5,39 91 ,43 62 )',0), 1, 0, 0, 1,505,-164));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT EMPTY', 0)), 1, 0, 0, 1,-793,87));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((43 25,41 51 ,67 10 ,38 16 ,48 50 ,43 25)),((28 72,94 51 ,46 76 ,4 54 ,77 77 ,28 72)),((25 99,59 20 ,46 36 ,53 97 ,65 14 ,25 99)),((17 92,28 56 ,99 96 ,90 71 ,21 63 ,17 92)))',0), 1, 0, 0, 1,-279,106));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POLYGON((92 79,61 69 ,2 8 ,55 55 ,27 66 ,43 46 ,97 7 ,92 79))',0), 1, 0, 0, 1,-500,335));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-414,164));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((47 18,2 70 ,95 29 ,0 62 ,47 18)),((3 56,73 18 ,62 97 ,0 67 ,3 56)),((80 3,58 40 ,75 80 ,89 0 ,80 3)),((11 77,34 12 ,16 35 ,24 22 ,11 77)))',0), 1, 0, 0, 1,-878,-506));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('LINESTRING(95 47,4 6 ,34 43 )',0), 1, 0, 0, 1,54,-332));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPointFromText('MULTIPOINT((28 65),(69 7),(68 49),(15 9),(64 97),(48 15),(13 44),(84 17),(47 17),(82 63),(49 55))',0), 1, 0, 0, 1,130,12));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-147,319));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}