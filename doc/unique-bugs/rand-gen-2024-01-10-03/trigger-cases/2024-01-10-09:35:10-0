{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('POINT(81 22)',0), 1, 0, 0, 1,-399,-777));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((28 83,87 62 ,1 35 ,27 96 ,28 83)),((48 39,26 1 ,58 54 ,81 28 ,48 39)),((91 1,28 11 ,19 4 ,41 60 ,91 1)),((21 77,2 28 ,56 75 ,36 87 ,21 77)))',0), 1, 0, 0, 1,-915,-25));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((19 55,5 57 ,15 32 ,2 73 ,83 100 ,19 55)),((46 35,78 51 ,64 23 ,6 86 ,76 12 ,46 35)),((60 53,86 35 ,38 72 ,85 77 ,47 84 ,60 53)))',0), 1, 0, 0, 1,-409,-222));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOINT((34 17),(21 42),(42 47),(0 66),(45 43),(5 39),(69 23),(88 99),(37 99))',0), 1, 0, 0, 1,-43,390));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_PointFromText('POINT(79 86)',0), 1, 0, 0, 1,868,512));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-16,146));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,471,-288));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,156,-277));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((58 16),(67 63),(23 29),(93 87),(47 83),(9 82))', 0)), 1, 0, 0, 1,860,-131));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((96 61,51 78 ,49 68 ,52 52 ,96 61)),((66 55,43 11 ,79 87 ,47 77 ,66 55)),((100 87,45 51 ,81 54 ,21 8 ,100 87)))',0), 1, 0, 0, 1,-417,196));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET valid = ST_IsValid(geom); "}