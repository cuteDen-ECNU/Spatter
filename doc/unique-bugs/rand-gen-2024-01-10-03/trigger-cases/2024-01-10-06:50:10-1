{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('LINESTRING(54 2,66 69 ,48 30 ,54 2)',0), 1, 0, 0, 1,46,516));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((13 49),(13 82),(44 37),(32 56),(8 97))', 0)), 1, 0, 0, 1,-57,164));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,886,-975));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPolyFromText('MULTIPOLYGON EMPTY',0), 1, 0, 0, 1,685,950));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_PolygonFromText('POLYGON((78 45,8 49 ,12 33 ,12 67 ,48 21 ,26 83 ,85 20 ,92 10 ,76 71 ,78 45))',0), 1, 0, 0, 1,-975,815));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((51 18,52 22 ,97 80 ,40 78 ,51 18)),((77 75,80 42 ,7 7 ,18 58 ,77 75)),((61 88,53 8 ,2 96 ,30 21 ,61 88)),((46 100,12 29 ,25 85 ,3 97 ,46 100)))',0), 1, 0, 0, 1,299,308));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_PointFromText('POINT(7 100)',0), 1, 0, 0, 1,754,-41));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((4 47,46 85 ,71 27 ,18 51 ,59 42 ,4 47)),((90 85,87 84 ,87 0 ,53 37 ,76 39 ,90 85)),((60 6,76 83 ,7 87 ,79 51 ,10 88 ,60 6)))',0), 1, 0, 0, 1,776,-79));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((78 46,2 66 ,33 22 ,8 27 ,71 31 ,78 46)),((74 40,34 72 ,81 2 ,66 29 ,100 42 ,74 40)),((13 81,62 5 ,1 95 ,93 9 ,63 80 ,13 81)))',0), 1, 0, 0, 1,350,-105));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT((15 45),(91 39)),MULTIPOINT((53 79),(35 20),(26 83)))',0), 1, 0, 0, 1,916,-16));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForceCollection(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}