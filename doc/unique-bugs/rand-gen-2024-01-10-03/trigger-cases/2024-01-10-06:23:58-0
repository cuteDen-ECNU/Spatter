{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(6,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT((41 7),(51 32),(72 74)),POINT(22 82))',0), 1, 0, 0, 1,459,-345));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,-837,469));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,890,895));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOINT((25 67),(16 7),(48 12),(19 53),(74 58),(44 77),(82 18),(46 5),(82 80))',0), 1, 0, 0, 1,-330,-783));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((86 70,91 97 ,44 83 ,26 58 ,86 70)),((49 13,9 3 ,8 83 ,27 19 ,49 13)),((10 76,24 54 ,69 89 ,72 33 ,10 76)),((27 67,91 9 ,15 24 ,72 41 ,27 67)))',0), 1, 0, 0, 1,-428,961));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_LineFromText('LINESTRING(33 15,76 80 ,52 39 ,33 15)',0), 1, 0, 0, 1,50,-389));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('LINESTRING(50 27,69 11 ,79 55 ,50 27)',0), 1, 0, 0, 1,-517,-997));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((97 73,63 98 ,31 21 ,67 55 ,72 77 ,97 73)),((93 28,67 83 ,22 79 ,60 22 ,78 85 ,93 28)),((52 5,50 33 ,11 43 ,97 30 ,82 73 ,52 5)),((70 35,96 59 ,81 5 ,6 99 ,80 23 ,70 35))),MULTILINESTRING((22 82,72 0 ,22 82)))',0), 1, 0, 0, 1,-798,61));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_LineFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,892,-970));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('POINT(86 99)',0), 1, 0, 0, 1,28,-308));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_ForceCollection(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}