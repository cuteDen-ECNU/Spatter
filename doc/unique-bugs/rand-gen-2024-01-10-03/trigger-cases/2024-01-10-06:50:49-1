{"query1": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(6,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(LINESTRING(48 2,50 41 ,19 72 ))',0), 1, 0, 0, 1,-820,-642));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((12 60,7 8 ,25 59 ,26 1 ,12 60)),((75 39,10 91 ,98 29 ,15 50 ,75 39)),((84 47,63 83 ,70 66 ,4 88 ,84 47)),((98 95,62 37 ,25 18 ,40 90 ,98 95))),POINT(85 10))',0), 1, 0, 0, 1,-891,535));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,855,-505));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('LINESTRING(91 74,94 100 ,76 87 ,91 74)',0), 1, 0, 0, 1,675,26));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,11,-700));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((38 81,53 51 ,54 39 ,58 38 ,49 17 ,38 81)),((7 22,61 28 ,50 69 ,2 48 ,92 64 ,7 22)),((43 21,54 21 ,77 3 ,68 65 ,32 6 ,43 21)),((68 68,25 59 ,6 40 ,98 88 ,63 41 ,68 68)))',0), 1, 0, 0, 1,251,-180));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,254,-356));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_PointFromText('POINT(86 1)',0), 1, 0, 0, 1,825,751));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((24 49,37 69 ,8 58 ,75 63 ,81 54 ,24 49)),((21 32,55 71 ,65 14 ,47 71 ,38 94 ,21 32)))',0), 1, 0, 0, 1,-659,915));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_LineFromText('LINESTRING(79 59,66 7 ,86 48 ,79 59)',0), 1, 0, 0, 1,331,564));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}