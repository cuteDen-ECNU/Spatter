{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING HASH (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-716,-8));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((29 47,14 79 ,2 81 ,31 48 ,29 47)),((59 1,97 95 ,84 26 ,35 62 ,59 1)))',0), 1, 0, 0, 1,-21,-405));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((94 88,92 94 ,94 35 ,91 10 ,52 54 ,94 88)),((26 4,61 22 ,64 22 ,63 76 ,50 15 ,26 4)),((5 85,27 42 ,6 42 ,13 62 ,57 65 ,5 85)))',0), 1, 0, 0, 1,395,744));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING((66 72,89 6 ,66 72), (8 94,0 78 )))',0), 1, 0, 0, 1,-486,551));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-820,657));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((15 0,39 50 ,54 70 ,72 39 ,15 0)),((95 39,37 97 ,36 85 ,87 18 ,95 39)),((63 11,42 73 ,26 87 ,37 90 ,63 11)),((67 82,4 10 ,82 63 ,97 8 ,67 82))),MULTIPOINT((91 83),(72 6)))',0), 1, 0, 0, 1,-770,968));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_MPointFromText('MULTIPOINT((94 75),(3 83),(8 41),(52 87),(5 40),(36 94),(25 89),(1 88),(68 87),(28 93),(80 32))',0), 1, 0, 0, 1,-484,103));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('POINT(57 62)',0), 1, 0, 0, 1,575,-83));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_PointFromText('POINT(82 1)',0), 1, 0, 0, 1,-310,392));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MLineFromText('MULTILINESTRING((62 30,57 9 ,62 30))',0), 1, 0, 0, 1,-848,53));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}