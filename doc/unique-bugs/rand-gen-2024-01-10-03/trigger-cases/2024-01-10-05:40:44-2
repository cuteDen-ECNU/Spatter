{"query1": "SELECT COUNT(*)         FROM t1 As a1          RIGHT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          RIGHT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOINT((44 70),(38 36),(81 94),(82 55),(17 98),(80 96),(44 78))',0), 1, 0, 0, 1,-488,303));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((6 17,63 24 ,54 76 ,15 62 ,76 73 ,6 17)),((30 71,7 27 ,30 28 ,29 42 ,17 69 ,30 71)),((64 46,87 60 ,54 43 ,28 100 ,36 23 ,64 46)),((39 28,85 83 ,24 23 ,51 80 ,77 4 ,39 28)))',0), 1, 0, 0, 1,-873,-55));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTILINESTRING((0 34,100 34 ,0 34), (0 55,1 49 ,0 55))',0), 1, 0, 0, 1,984,617));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,-135,157));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTILINESTRING((11 42,28 94 ))',0), 1, 0, 0, 1,-77,105));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_MPointFromText('MULTIPOINT((84 73),(11 68),(55 27),(33 11))',0), 1, 0, 0, 1,408,489));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_LineFromText('LINESTRING(36 47,3 23 ,51 61 )',0), 1, 0, 0, 1,-884,-291));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('MULTILINESTRING EMPTY',0), 1, 0, 0, 1,84,-736));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((90 60,11 94 ,51 59 ,90 60)),((0 10,78 23 ,48 18 ,0 10)),((42 70,75 89 ,37 38 ,42 70)),((21 100,98 24 ,3 100 ,21 100)))',0), 1, 0, 0, 1,-364,149));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((31 50,78 15 ,99 82 ,100 83 ,31 50)),((84 73,100 1 ,52 94 ,57 82 ,84 73)),((69 76,19 95 ,34 2 ,59 83 ,69 76)),((45 58,88 47 ,100 56 ,1 1 ,45 58)))',0), 1, 0, 0, 1,-50,555));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}