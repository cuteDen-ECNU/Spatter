{"query1": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_DFullyWithin(a1.geom, a2.geom, 547)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(4,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_DFullyWithin(a1.geom, a2.geom, 547)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(6,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING GIST (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION(LINESTRING EMPTY,MULTILINESTRING((27 46,14 95 ), (36 20,5 74 ,36 20)))',0), 1, 0, 0, 1,-439,-822));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOINT((62 47),(95 78),(17 91),(93 3),(37 58))',0), 1, 0, 0, 1,29,-274));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((25 34,48 52 ,41 87 ,47 36 ,3 75 ,25 34)),((3 9,20 41 ,66 99 ,81 4 ,99 94 ,3 9)),((65 1,66 80 ,86 99 ,25 59 ,56 100 ,65 1)))',0), 1, 0, 0, 1,-971,-207));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((86 38),(30 88),(54 98),(77 5),(8 94),(3 15),(31 25),(84 20))', 0)), 1, 0, 0, 1,308,-663));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((87 10,37 18 ,12 67 ,90 44 ,25 44 ,87 10)),((99 33,15 29 ,79 35 ,87 38 ,17 75 ,99 33)),((28 42,73 100 ,9 28 ,95 5 ,4 28 ,28 42)),((52 78,3 91 ,93 100 ,54 10 ,9 24 ,52 78)))',0), 1, 0, 0, 1,-25,-882));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('POINT(27 23)',0), 1, 0, 0, 1,928,349));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('LINESTRING(56 83,60 99 ,69 54 ,56 83)',0), 1, 0, 0, 1,398,-669));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('POINT(70 72)',0), 1, 0, 0, 1,-735,-709));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_LineFromText('LINESTRING(87 83,62 25 ,46 84 ,87 83)',0), 1, 0, 0, 1,-870,-406));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,403,298));  DELETE FROM t0 As a1 WHERE ST_IsEmpty(a1.geom) ;  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_RemoveRepeatedPoints(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}