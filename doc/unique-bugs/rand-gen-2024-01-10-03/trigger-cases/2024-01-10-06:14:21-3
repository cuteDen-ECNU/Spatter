{"query1": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING BTREE (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-959,-661));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_PointFromText('POINT(75 37)',0), 1, 0, 0, 1,430,-52));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((90 61,8 20 ,91 60 ,41 33 ,68 10 ,90 61)),((82 81,35 43 ,52 22 ,11 35 ,5 21 ,82 81)),((43 72,6 43 ,10 26 ,38 6 ,31 61 ,43 72)))',0), 1, 0, 0, 1,-553,-715));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MLineFromText('MULTILINESTRING((18 28,92 3 ,94 24 ,18 28))',0), 1, 0, 0, 1,851,-876));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POLYGON((20 93,72 22 ,58 66 ,55 53 ,34 4 ,31 5 ,25 86 ,43 9 ,20 93))',0), 1, 0, 0, 1,680,-411));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-402,-665));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('LINESTRING(84 42,43 83 ,55 82 )',0), 1, 0, 0, 1,388,-386));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((91 32,12 87 ,21 46 ,91 32)),((16 59,72 98 ,2 5 ,16 59)),((26 67,96 58 ,8 88 ,26 67)),((70 16,12 96 ,95 47 ,70 16)))',0), 1, 0, 0, 1,-256,49));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('POINT(21 67)',0), 1, 0, 0, 1,-685,-862));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_PointFromText('POINT(1 22)',0), 1, 0, 0, 1,482,439));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_RemoveRepeatedPoints(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}