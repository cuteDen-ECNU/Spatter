{"query1": "SELECT COUNT(*)         FROM t1 As a1          LEFT OUTER JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(0,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          LEFT OUTER JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(2,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_MPointFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,442,316));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((12 10,9 55 ,34 65 ,59 99 ,32 65 ,12 10)),((74 65,63 72 ,56 2 ,100 82 ,75 8 ,74 65)))',0), 1, 0, 0, 1,-283,-854));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_MLineFromText('MULTILINESTRING((20 66,17 86 ,20 66), (55 90,80 65 ,55 90))',0), 1, 0, 0, 1,-689,-132));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_MPointFromText('MULTIPOINT((28 63),(93 21),(99 34))',0), 1, 0, 0, 1,-504,185));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('POLYGON((75 58,71 42 ,56 20 ,61 80 ,43 46 ,39 70 ,75 58))',0), 1, 0, 0, 1,-476,-137));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomCollFromText('GEOMETRYCOLLECTION EMPTY',0), 1, 0, 0, 1,-942,983));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('POLYGON((31 61,13 44 ,31 71 ,99 98 ,14 34 ,54 34 ,31 61))',0), 1, 0, 0, 1,-526,258));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_MLineFromText('MULTILINESTRING((15 78,67 100 ,15 78))',0), 1, 0, 0, 1,-140,-47));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((49 46,41 10 ,24 99 ,49 46)),((11 38,52 37 ,5 86 ,11 38)),((18 93,55 21 ,85 39 ,18 93)))',0), 1, 0, 0, 1,-138,563));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((0 90,96 28 ,70 53 ,0 90)),((43 63,32 83 ,18 35 ,43 63)),((71 97,38 24 ,47 51 ,71 97)),((43 69,47 94 ,7 13 ,43 69)))',0), 1, 0, 0, 1,568,647));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Normalize(geom);  UPDATE t1 SET valid = ST_IsValid(geom); "}