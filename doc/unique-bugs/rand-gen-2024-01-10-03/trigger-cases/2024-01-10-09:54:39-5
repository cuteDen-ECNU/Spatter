{"query1": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_DWithin(a1.geom, a2.geom, 968)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(24,)]", "query2": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_DWithin(a1.geom, a2.geom, 968)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(19,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING BTREE (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((90 49,46 30 ,43 100 ,72 20 ,90 49)),((99 99,16 60 ,70 68 ,73 25 ,99 99)))',0), 1, 0, 0, 1,342,-432));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((57 4,72 28 ,48 2 ,56 36 ,12 4 ,57 4)),((42 67,99 29 ,51 59 ,45 53 ,45 41 ,42 67)))',0), 1, 0, 0, 1,125,-10));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_GeomFromText('MULTILINESTRING((72 92,24 17 ,72 92))',0), 1, 0, 0, 1,961,470));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOINT((71 17),(44 68),(99 93),(63 15),(37 77),(36 66),(93 100),(86 49),(48 83))',0), 1, 0, 0, 1,-195,-958));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING EMPTY,LINESTRING(88 79,45 98 ,95 62 ,87 34 ,88 79))',0), 1, 0, 0, 1,-205,-860));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_PointFromText('POINT(52 87)',0), 1, 0, 0, 1,76,-684));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_PointFromText('POINT(67 14)',0), 1, 0, 0, 1,530,-947));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('POINT(60 86)',0), 1, 0, 0, 1,601,-934));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING((17 58,2 63 ), (3 90,65 40 )),GEOMETRYCOLLECTION EMPTY)',0), 1, 0, 0, 1,-480,117));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,-280,-649));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_CollectionHomogenize(geom);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}