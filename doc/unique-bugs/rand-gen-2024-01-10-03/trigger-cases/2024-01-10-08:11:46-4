{"query1": "SELECT COUNT(*)         FROM t0 As a1          JOIN t0 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res1": "[(6,)]", "query2": "SELECT COUNT(*)         FROM t1 As a1          JOIN t1 As a2 ON ST_Equals(a1.geom, a2.geom)          WHERE  a1.valid = True and a2.valid = True and a1.id <> a2.id;", "res2": "[(0,)]", "t0_queries": "DROP TABLE IF EXISTS t0;  CREATE TABLE t0 (id int, geom geometry, valid boolean);  CREATE INDEX t0_idx ON t0 USING HASH (geom);  DROP TABLE IF EXISTS t1;  CREATE TABLE t1 (id int, geom geometry, valid boolean);  CREATE INDEX t1_idx ON t1 USING GIST (geom);  INSERT INTO t0 (id, geom) VALUES (0,ST_Affine(ST_GeomFromText('LINESTRING EMPTY',0), 1, 0, 0, 1,773,-720));  INSERT INTO t0 (id, geom) VALUES (1,ST_Affine(ST_GeomFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((32 44,24 3 ,45 56 ,11 57 ,32 44)),((94 20,32 39 ,49 25 ,8 73 ,94 20)),((15 33,64 60 ,35 38 ,7 52 ,15 33))))',0), 1, 0, 0, 1,318,-49));  INSERT INTO t0 (id, geom) VALUES (2,ST_Affine(ST_ConvexHull(ST_MPointFromText('MULTIPOINT((66 6),(58 28),(94 1),(39 51),(41 80),(84 7),(55 56))', 0)), 1, 0, 0, 1,701,776));  INSERT INTO t0 (id, geom) VALUES (3,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((57 8,60 59 ,65 73 ,57 8)),((27 12,65 32 ,0 24 ,27 12)),((90 21,27 77 ,69 63 ,90 21)),((45 91,43 38 ,20 77 ,45 91)))',0), 1, 0, 0, 1,565,-975));  INSERT INTO t0 (id, geom) VALUES (4,ST_Affine(ST_GeomFromText('MULTIPOINT EMPTY',0), 1, 0, 0, 1,142,501));  INSERT INTO t0 (id, geom) VALUES (5,ST_Affine(ST_GeomFromText('MULTIPOLYGON(((52 53,96 2 ,96 96 ,56 44 ,52 53)),((44 18,87 54 ,94 59 ,66 41 ,44 18)))',0), 1, 0, 0, 1,-709,-153));  INSERT INTO t0 (id, geom) VALUES (6,ST_Affine(ST_GeomFromText('LINESTRING(93 85,23 89 ,91 42 ,93 85)',0), 1, 0, 0, 1,515,959));  INSERT INTO t0 (id, geom) VALUES (7,ST_Affine(ST_GeomFromText('POLYGON EMPTY',0), 1, 0, 0, 1,-225,206));  INSERT INTO t0 (id, geom) VALUES (8,ST_Affine(ST_LineFromText('LINESTRING(4 87,79 46 ,77 18 )',0), 1, 0, 0, 1,84,682));  INSERT INTO t0 (id, geom) VALUES (9,ST_Affine(ST_MPolyFromText('MULTIPOLYGON(((8 89,22 33 ,29 56 ,8 89)),((52 91,35 73 ,71 81 ,52 91)),((55 24,14 76 ,69 94 ,55 24)),((11 94,28 54 ,67 71 ,11 94)))',0), 1, 0, 0, 1,632,-184));  UPDATE t0 SET valid = ST_IsValid(geom);  INSERT INTO t1 (id, geom) SELECT id, geom FROM t0;  UPDATE t1 SET geom = ST_Collect(ARRAY[geom]);  UPDATE t1 SET valid = t0.valid         FROM t0         WHERE t1.id = t0.id; "}